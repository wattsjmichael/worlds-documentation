<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:image" content="images/MHCP_OG_image.jpg"/>
  <meta property="og:image:type" content="image/jpeg" />
  <meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
  <title>MHCP Creator Made Docs</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>

@font-face {
  font-family: 'Optimistic';
  src: url('fonts/OptimisticText-Regular.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

.site-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: white;
  color: black;
  position: sticky;
  top: 0;
  z-index: 1000;
  flex-wrap: nowrap;
  flex-direction: row;
  width: 97%;
  border-bottom: 1px solid #ccc;
  padding: 1rem 2rem;
}
.hamburger {
  display: none;
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
}
.nav-links {
    margin-top: 1rem;
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
    font-size: 0.875rem;
}
.left-nav {
  display: flex;
  align-items: center;
  gap: 1rem; /* space between logo and nav */
  flex: 1;
  min-width: 0;
}
.logo {
  font-size: 1.5rem;
  font-weight: bold;
  flex-shrink: 0;
  line-height: 1;
  margin: 0;
  padding: 0;
  display: block;
  align-items: center;
  height: 100%;
  padding-top: 0.5rem;
}
.logo a {
  text-decoration: none;
  color: inherit !important;
  display: flex;
  align-items: center;
  height: 100%;
}
.fa-youtube {
  font-size: 1.2rem;
  vertical-align: middle;
  color: #FF0000;
  transition: color 0.2s;
  padding: 1rem;
}
.fa-youtube:hover {
  color: #990000;
}
/* Desktop: keep header-row styles neutral */
.header-row {
  display: contents; /* makes the wrapper disappear for layout */
}
.mobile-only {
  display: none;
}
.nav-links a {
  color: black;
  text-decoration: none;
  margin-left: 2rem;
  font-weight: 500;
  transition: color 0.2s ease-in-out;
}
.nav-links a:hover {
  color: #0064E0;
}
.page-body {
  display: flex;
  flex: 1;
  min-height: 0;
  overflow: hidden;
}
    body {
      font-family: 'Optimistic', sans-serif;
      margin: 0;
      display: flex;
      height: 100vh;
      flex-direction: column;
      width: 100vw;
    }
    .sidebar {
      width: 250px;
      background-color: #E9F3FF;
      padding: 1rem;
      overflow-y: auto;
      border-right: 1px solid #ddd;
      padding-left: 2rem;
    }
    .sidebar h2 {
      font-size: 1.5rem;
      font-weight: 600;
    }
    .sidebar input[type="text"] {
      width: 70%;
      padding: 0.5rem 2rem 0.5rem 2rem;
      margin-bottom: 1rem;
      border: 1px solid #aaa;
      border-radius: 25px;
      font-size: 1rem;
      background-color: white;
      color: black;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%23666" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a8 8 0 105.29 14.29l4.7 4.7 1.41-1.41-4.7-4.7A8 8 0 0010 2zm0 2a6 6 0 110 12 6 6 0 010-12z"/></svg>');
      background-repeat: no-repeat;
      background-position: 0.6rem center;
      background-size: 1rem;
      
    }
    .sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .sidebar li {
      margin-top: 0.25rem;
    }
    .sidebar a {
      text-decoration: none;
      color: black;
      font-weight: 300;
      padding: 0.5rem 0.5rem;
      margin-left: 0.5rem;
      display: block;
      border-radius: 4px;
      font-size: 0.875rem;
    }
    .sidebar a:hover {
      color: #0064E0;
      background-color: #e0ebf9;
    }
    .sidebar a.active {
      background-color: white;
      color: #0064E0;
      font-weight: 600;
    }
    .sidebar a::first-letter{
      text-transform: capitalize;
    }
    .sidebar-close {
  display: none;
}
.chevron-icon {
  transition: transform 0.2s ease;
  margin-left: 0.5rem;
  vertical-align: middle;
  width: 0.75rem;
  height: 0.75rem;
  flex-shrink: 0;
}

.dropdown.open + .chevron-icon,
.folder-toggle.open .chevron-icon {
  transform: rotate(90deg);
}

    .dropdown {
      margin-left: 1rem;
      display: none;
      transition: max-height 0.3s ease;
      overflow: hidden;
      max-height: 0;
    }
    .dropdown.open {
      display: block;
        max-height: 1000px; /* large enough to reveal children */
    }
    .folder-toggle {
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      margin: 0.25rem 0;
      border-radius: 4px;
      cursor: pointer;
      box-sizing: border-box;
      column-gap: 1.5rem;
      width: 100%;
    }
    .folder-toggle .icon {
      display: inline-flex;
      width: 1rem;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    .folder-toggle:hover {
      background-color: #d9e9ff;
      border-radius: 4px;
    }
    .folder-toggle.open {
      background-color: #d0e4ff; /* light blue background */
      color: #0064E0; /* dark blue text */
      font-weight: 600;
      border-left: 4px solid #0064E0;

    }

    .folder-name {
      white-space: normal;
      line-height: 1.3;
     }
    .folder-name.indent-level-1 { 
      padding-left: 1.2rem; 
    }
    .folder-name.indent-level-2 { 
      padding-left: 2.4rem; 
    }
    span.folder-name::first-letter{
      text-transform: capitalize;
    }
    .right-sidebar {
      width: 220px;
      background-color: #fafafa;
      padding: 1rem;
      overflow-y: auto;
      border-left: 1px solid #ddd;
      position: sticky;
      top: 0;
      max-height: 100vh;

    }
    .right-controls {
  display: flex;
  align-items: center;
  flex-shrink: 0;
  padding-left: 4rem;
}
    .right-sidebar h3 {
      font-size: 0.9rem;
      text-transform: uppercase;
      margin-bottom: 0.5rem;
    }
    .right-sidebar ul {
      list-style: none;
      padding: 0;
      font-size: 0.875rem;
    }
    .right-sidebar li {
      margin: 0.25rem 0;
    }
    .right-sidebar a {
      text-decoration: none;
      color: black;
      font-weight: 300;
      padding: 0.25rem 0.5rem;
      display: block;
      border-radius: 4px;
    }
    .right-sidebar a:hover,
    .right-sidebar a.active {
      font-weight: bold;
      color: #0064E0;
      background-color: #E9F3FF;
    }
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
      scroll-behavior: smooth;
    }
    .doc-container {
      max-width: 85%;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
       min-height: 80vh; /* adjust as needed */
    }
    #doc-content {
    flex: 1;
    max-width: 100%;
    }


    #doc-content iframe {
  width: 100%;
  max-width: 100%;
  height: auto;
  aspect-ratio: 16 / 9;
  display: block;
  margin: 1rem 0;
}

    #doc-content pre,
    #doc-content code {
      max-width: 100%;
      overflow-x: auto;
      word-wrap: break-word;
      white-space: pre-wrap; /* optional: wrap code if needed */
    }
    #doc-content img {
      max-width: 100%;
      height: auto;
      display: block;
    }
    #doc-list {
      margin-top: 0;
      padding-left: 0;
    }
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 2rem;
    }
    .nav-buttons button {
      padding: 1rem 2rem;
      font-size: 1rem;
      cursor: pointer;
      background-color: white;
      color: black;
      border: 1px solid black;
      border-radius: 4px;
      margin-bottom: 2rem;
    }
    .nav-buttons button:disabled {
      background-color: #ccc;
      cursor: default;
    }

  body[data-theme="dark"] {
    background-color: #1a1a1a;
    color: #e0e0e0;
  }

[data-theme="dark"] .site-header {
  background-color: #1a1a1a;
  color: #f3f3f3;
  border-bottom: 1px solid #333;
}
body[data-theme="dark"] {
  scrollbar-color: #555 #000000; /* thumb and track */
  scrollbar-width: thin;
}
body[data-theme="dark"] .nav-links a {
  color: #f3f3f3;
}
body[data-theme="dark"] .nav-links a:hover {
  color: #0a84ff;
}
body[data-theme="dark"] .folder-toggle {
  color: #e0e0e0;
}
body[data-theme="dark"] .folder-toggle:hover {
  color: #0a84ff;
      background-color: #333;
}
body[data-theme="dark"] .folder-toggle.open {
  background-color: #2b2b2b;
  color: #4DA3FF;
  border-left: 4px solid #0064E0;
}
  body[data-theme="dark"] .sidebar a,
  body[data-theme="dark"] .right-sidebar a {
    color: #e0e0e0;
  }

  body[data-theme="dark"] .sidebar a:hover,
  body[data-theme="dark"] .right-sidebar a:hover {
    color: #0a84ff;
    background-color: #333;
  }

  body[data-theme="dark"] .sidebar,
  body[data-theme="dark"] .right-sidebar {
    background-color: #1e1e1e;
    border-color: #333;
  }

  body[data-theme="dark"] .sidebar input[type="text"] {
    background-color: #2b2b2b;
    color: #ffffff;
    border-color: #555;
  }
  body[data-theme="dark"] .sidebar a.active,
  body[data-theme="dark"] .right-sidebar a.active {
    background-color: #121212;
    color: #ccc;
  }

  body[data-theme="dark"] .content,
  body[data-theme="dark"] .doc-container,
  body[data-theme="dark"] #doc-content {
    background-color: #121212;
    color: #e0e0e0;
  }

  body[data-theme="dark"] #doc-content {
  color: #f5f5f5;
  background-color: #121212;
}

body[data-theme="dark"] #doc-content a {
  color: #4DA3FF;
}

body[data-theme="dark"] #doc-content h1,
body[data-theme="dark"] #doc-content h2,
body[data-theme="dark"] #doc-content h3,
body[data-theme="dark"] #doc-content h4,
body[data-theme="dark"] #doc-content h5,
body[data-theme="dark"] #doc-content h6 {
  color: #ffffff;
}

body[data-theme="dark"] #doc-content code {
  background-color: #1e1e1e;
  color: #ffcc99;
  padding: 0.2em 0.4em;
  border-radius: 4px;
}

body[data-theme="dark"] #doc-content pre {
  background-color: #1e1e1e;
  color: #eaeaea;
  padding: 1rem;
  overflow-x: auto;
  border-radius: 6px;
}


  body[data-theme="dark"] .nav-buttons button {
    background-color: #1f1f1f;
    color: #e0e0e0;
    border-color: #555;
  }

  #theme-toggle {
  font-size: 1.2rem;
  background: none;
  border: none;
  cursor: pointer;
  padding: 0.5rem;
  padding-bottom: 0.75rem;
}


@media (max-width: 1100px) {
.doc-container {
    max-width: 100%;
}
    table {
    display: block;
    width: 100%;
    width: max-content;
    max-width: 100%;
    overflow: auto;
}
.site-header {
    flex-direction: column;
    align-items: stretch;
    padding: 1rem;
  }
.header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }
.hamburger {
    display: block;
    font-size: 1.5rem;
    background: none;
    border: none;
    cursor: pointer;
}
.sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
    transform: translateX(-100%);
    width: 80vw;
    max-width: 300px;
    transition: transform 0.3s ease;
    z-index: 1001;
    min-height: 100vh;
}
.sidebar.open {
    transform: translateX(0);
    box-shadow: 2px 0 8px rgba(0, 0, 0, 0.2);

}
  .sidebar-backdrop {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0,0,0,0.3);
    z-index: 999;
    transition: opacity 0.3s ease;
    opacity: 0;
    pointer-events: none;
  }
  .sidebar-backdrop.show {
    display: block;
    opacity: 1;
    pointer-events: auto;
  }
  /* Ensure page body doesn't scroll while menu is open */
  body.sidebar-open {
    overflow: hidden;
  }
  .left-nav {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex: 1;
  }
  .nav-links,
  .search-container {
    display: none; /* hide nav and search */
  }
  .site-header.active .nav-links,
  .site-header.active .search-container {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    width: 100%;
    margin-top: 1rem;
  }
  .site-header.active .search-container {
    margin-top: 0.5rem;
  }
  .logo {
    display: none;
  }
  .mobile-title {
    font-size: 1.2rem;
    font-weight: 600;
    line-height: 1;
    margin: 0;
    padding-top: 0.5rem;
    text-decoration: none;
}
    .desktop-only {
  }
  .mobile-only {
    display: block !important;
  }
    .mobile-title a {
      text-decoration: none !important;
      color: #000000;
    }
    .mobile-title a:visited {
      text-decoration: none !important;
    }
    .mobile-title a:hover,
    .mobile-title a:active {
      text-decoration: none !important;
    }
  .right-controls {
    display: flex;
    justify-content: flex-end;
    flex-shrink: 0;
    align-items: center;
    padding-left: 0;
  }
  .right-sidebar {
    display: none !important;
  }
  .sidebar-close {
    display: block;
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    z-index: 1002;
}
body[data-theme="dark"] .sidebar-close {
  color: white;
}
body[data-theme="dark"] .hamburger {
  color: white;
}
}
body[data-theme="dark"]  .mobile-title a {
    text-decoration: none !important;
    color: white;
    }
/* === Footer === */
.site-footer {
  text-align: center;
  font-size: 0.9rem;
  color: #888;
  background-color: #f1f1f1;
  border-top: 1px solid #ccc;
  padding: 1rem;
}
.site-footer p {
  margin: 0 !important;
  border: none !important;
}
.site-footer a {
  color: #4DA3FF !important;
  text-decoration: none;
}
.site-footer a:hover {
  text-decoration: underline;
  color: #0064E0 !important;
}
body[data-theme="dark"] .site-footer {
  border-top: 1px solid #333;
  background-color: #1a1a1a;
}
.site-footer .footer-links {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
}

.site-footer .fab.fa-youtube {
  font-size: 1.2rem;
  color: #FF0000;
  padding: 0.5rem;
}
.site-footer .fab.fa-youtube:hover {
  color: #990000;
}
@media (max-width: 1100px) {
.mobile-sidebar-divider {
  margin: 1.5rem 0;
  border: 0;
  border-top: 1px solid #ccc;
}

.mobile-sidebar-nav {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-bottom: 2rem;
}

.mobile-sidebar-nav a {
  text-decoration: none;
  color: black;
  font-size: 0.875rem;
  font-weight: 500;
  padding: 0.5rem 1rem;
  border-radius: 4px;
}

.mobile-sidebar-nav a:hover {
  background-color: #d9e9ff;
  color: #0064E0;
}

body[data-theme="dark"] .mobile-sidebar-nav a {
  color: #e0e0e0;
}

body[data-theme="dark"] .mobile-sidebar-nav a:hover {
  background-color: #333;
  color: #4DA3FF;
}
}

main.content {
  min-height: 0;
  display: flex;
  flex-direction: column;
}

  </style>
</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <div class="sidebar-backdrop" id="sidebar-backdrop"></div>
      <div class="header-row">
    <div class="left-nav">
    <button class="hamburger" id="menu-toggle">‚ò∞</button>
    <div class="logo"><a href="https://mhcpcreators.github.io/worlds-documentation/" id="logo-link">MHCP Creator Made Docs</a></div>
    <div class="mobile-title mobile-only"><a href="https://mhcpcreators.github.io/worlds-documentation/">Creator Docs</a></div>
    <nav class="nav-links">
      <a href="https://mhcpcreators.github.io/worlds-documentation/docs.html#docs%2Fmanuals-and-cheat-sheets%2FGet%20Started.md">Creator Docs</a>
      <a href="https://developers.meta.com/horizon-worlds/learn">Meta Docs</a>
      <a href="https://github.com/MHCPCreators/horizonCreatorManual">Creator Manual</a>
      <a href="https://communityforums.atmeta.com/t5/Creator-Forum/ct-p/Meta_Horizon_Creator_Forums">Forums</a>
      <a href="https://mhcpcreators.github.io/worlds-documentation/docs.html#docs%2Fmanuals-and-cheat-sheets%2FContribute%20to%20Creator%20Documentation.md">Contribute</a>
    </nav>
    </div>
          <div class="right-controls">
              <a href="https://www.youtube.com/@creatorprograms" target="_blank" style="color: #FF0000;">
            <i class="fab fa-youtube"></i>
            </a>
      <button id="theme-toggle" aria-label="Toggle dark mode">üåô/‚òÄÔ∏è</button>
  </div>
  </div>
</header>
<div class="page-body">
  <aside class="sidebar">
  <button class="sidebar-close" id="sidebar-close" aria-label="Close sidebar">‚úï</button>
    <h2>Overview</h2>
<input type="text" id="search-input" placeholder="Search documents..." />
    <ul id="doc-list"></ul>
    <hr class="mobile-sidebar-divider mobile-only" />
<div class="mobile-sidebar-nav mobile-only">
  <a href="https://mhcpcreators.github.io/worlds-documentation/docs.html#docs%2Fmanuals-and-cheat-sheets%2FGet%20Started.md">Creator Docs</a>
  <a href="https://developers.meta.com/horizon-worlds/learn">Meta Docs</a>
  <a href="https://github.com/MHCPCreators/horizonCreatorManual">Creator Manual</a>
  <a href="https://communityforums.atmeta.com/t5/Creator-Forum/ct-p/Meta_Horizon_Creator_Forums">Forums</a>
  <a href="https://mhcpcreators.github.io/worlds-documentation/docs.html#docs%2Fmanuals-and-cheat-sheets%2FContribute%20to%20Creator%20Documentation.md">Contribute</a>
</div>

  </aside>

  <main class="content">
    <div class="doc-container">
      <div id="doc-content">Select a document to begin reading.</div>
      <div class="nav-buttons">
        <button id="prev-btn">‚Üê Previous</button>
        <button id="next-btn">Next ‚Üí</button>
      </div>
    </div>
  </main>

  <aside class="right-sidebar">
    <h3>On this page</h3>
    <ul id="doc-toc"></ul>
  </aside>
  </div>

  <!-- Footer -->
  <footer class="site-footer">
  <div class="footer-links">
    <p>Built by MHCP Creators ‚Ä¢ 
      <a href="https://github.com/MHCPCreators/worlds-documentation">GitHub</a> ‚Ä¢ 
      <a href="https://communityforums.atmeta.com/t5/Creator-Forum/ct-p/Meta_Horizon_Creator_Forums">Forums</a> ‚Ä¢
    </p>
    <a href="https://www.youtube.com/@creatorprograms" target="_blank" aria-label="Creator Programs YouTube Channel">
      <i class="fab fa-youtube"></i>
    </a>
  </div>
  </footer>

  <script>
    const GITHUB_RAW_BASE = "https://raw.githubusercontent.com/MHCPCreators/worlds-documentation/main";
  const docs = {
    "understanding-the-desktop-editor": ["Asset Spawning & World Streaming.md", "Boost Performance - Top 7 Spawning & Streaming Tricks.md", "Collaboratively Build with Shared Asset Templates.md", "Improve Frame Rates and Custom Asset Bloat.md", "Trace, Fix, & Optimize World Performance Issues.md", "Worlds Desktop Editor 101.md", "Worlds Desktop Tools Basics.md"],
    "creating-a-world": ["building-your-first-world.md", "Create a Clean Game HUD for Worlds.md", "Create a Versatile Holster System in Worlds.md", "Designing Worlds for Mobile AMA Session.md", "Inventory Systems - Unlock the Power of Player Inventories.md", "Mentor World Tour - Mechanics, Art, & Gameplay Loop Design.md", "Mobile Worlds Crash Course.md", "What Makes a Hit Mobile Game - 4 Winning Examples.md", "Worlds Tools Overview.md"],
    "generative-ai-tools": ["Build a Player-Guided Lobby with Mesh Gen.md", "Code Faster with Copilot in the Worlds Desktop Editor & VSCode.md", "GenAI Sound Design in Worlds - Audio Tools Tour.md", "GenAI World Concepts - Greyboxing and Refinements.md", "Hands-On with GenAI Toolkit for Worlds - Full Feature Tour.md", "Prompt Meta AI in the Worlds Desktop Editor.md", "Scripting with AI Support - GenAI TypeScript.md", "Topology Tune-Up for GenAI Props and Sets.md"],
    "getting-started-with-scripting": ["15 Worlds TypeScript API 2.0 Tips and Tricks.md", "Codeblocks to TypeScript.md", "PlayerControls API & Focused Interaction in Worlds.md", "TypeScript Basics- Beginner-Friendly Session for Worlds.md", "TypeScript Best Practices 101.md", "json-ppvs-and-versioning.md", "text-entry-tutorial.md"],
    "scripting-concepts-persistence-apis": ["custom-ui/Custom UI Basics to Boost Interaction.md", "custom-ui/cui-api-introduction.md", "custom-ui/Pro Tips & Tricks for a High-Performance Custom UI.md", "Interactive Laser Pen for Mobile Worlds Build-Along.md"],    
    "meshes-materials-import": ["15 Blender Tips for Horizon Assets.md", "3D Modeling in Worlds 101.md", "Blender Basics & UV Unwrapping", "Custom Skydomes Guide - Cinematic Horizons.md", "How to Use LODs to Boost Your World‚Äôs Performance.md", "Improve Custom Model Imports.md", "Masked Texture 3D Asset Challenge - AMA Session.md", "Optimize IWP Assets for Peak Performance.md", "Roads & Fences in Horizon - Paths 101.md", "Space Glitters Blender Basics Hotkey Sheet.pdf", "Worlds Asset Build-Along - Color Palette & Vertex Tuning.md", "import-images-and-add-texture-animation.md"],
    "manuals-and-cheat-sheets": ["Contribute to Creator Documentation.md", "Get Started.md", "How To Make Your World Go Viral.md", "MHCP_Publishing_Checklist.pdf", "MHCP_WorldPlanningGuide.pdf", "Plan Your World - Game Design & Monetization Sheet.md", "Publishing Checklist for Horizon Worlds.md", "World Building & Pre-Production Guide.md", "Worlds Creator Manual Essentials Made Easy.md", "worlds-workarounds.md"]
  };

  const docList = document.getElementById("doc-list");
  const content = document.getElementById("doc-content");
  const tocList = document.getElementById("doc-toc");
  const searchInput = document.getElementById("search-input");
  const prevBtn = document.getElementById("prev-btn");
  const nextBtn = document.getElementById("next-btn");

  
  let flatDocs = [];
  let currentIndex = 0;

  function buildSidebar() {
    docList.innerHTML = "";
    flatDocs = [];

function createFolder(folderName, filesOrSubfolders, parentPath = "docs", level = 0) {
  const container = document.createElement("li");
  const toggle = document.createElement("div");
  toggle.classList.add("folder-toggle");

toggle.setAttribute("role", "button");
toggle.setAttribute("tabindex", "0");

  const subList = document.createElement("ul");
  subList.className = "dropdown";

  const folderDisplayName = folderName.replace(/-/g, ' ');

  const isExpandable = (Array.isArray(filesOrSubfolders) && filesOrSubfolders.length > 0)
                    || (typeof filesOrSubfolders === 'object' && filesOrSubfolders !== null && Object.keys(filesOrSubfolders).length > 0);

toggle.innerHTML = `
  <span class="folder-name">${folderDisplayName}</span>
  ${isExpandable ? `
    <svg class="chevron-icon" width="12" height="12" viewBox="0 0 320 512" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
      <path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/>
    </svg>` : ''}
`;

  if (Array.isArray(filesOrSubfolders)) {
    filesOrSubfolders.forEach(file => {
      const docPath = `${parentPath}/${folderName}/${file}`;
      const title = file.replace(/\.md$/, '').replace(/[-_]/g, ' ');
      const doc = { path: docPath, title };
      flatDocs.push(doc);

      const li = document.createElement("li");
      const a = document.createElement("a");
      a.href = `#${encodeURIComponent(docPath)}`;
      a.textContent = title;
      a.style.paddingLeft = `${(level + 1) * 1.2}rem`;
      a.addEventListener("click", (e) => {
        e.preventDefault();
        loadDocByPath(docPath);
      });

      li.appendChild(a);
      subList.appendChild(li);
    });
  } else {
    for (const [subFolder, files] of Object.entries(filesOrSubfolders)) {
      const subTree = createFolder(subFolder, files, `${parentPath}/${folderName}`, level + 1);
      subList.appendChild(subTree);
    }
  }

  if (isExpandable) {
    toggle.addEventListener("click", () => {
      const isOpen = subList.classList.toggle("open");
      toggle.classList.toggle("open", isOpen); // Adds class to parent so SVG rotates
    });

  }

  container.appendChild(toggle);
  container.appendChild(subList);
  return container;
}


    for (const [folder, value] of Object.entries(docs)) {
      docList.appendChild(createFolder(folder, value));
    }

      const hashPath = decodeURIComponent(location.hash.slice(1));
  if (hashPath && flatDocs.some(doc => doc.path === hashPath)) {
    loadDocByPath(hashPath);
  } else {
    loadDocByPath(flatDocs[0].path);
   } 
  }


function loadDocByPath(path) {
  const index = flatDocs.findIndex(doc => doc.path === path);
  if (index === -1) {
    content.innerHTML = `<p>Document not found: ${path}</p>`;
    return;
  }

  currentIndex = index;

  // If PDF, directly embed in iframe without fetch
if (path.endsWith(".pdf")) {
  const pdfUrl = GITHUB_RAW_BASE + "/" + path.split("/").map(encodeURIComponent).join("/");

  const filename = path.split("/").pop().replace(/[-_]/g, " ").replace(/\.pdf$/i, "");
  content.innerHTML = `
    <h2>${filename}</h2>
    <p><a href="${pdfUrl}" target="_blank" rel="noopener noreferrer">Open PDF in new tab</a></p>
  `;
  return;
}



  // For markdown and other types, fetch and parse
const fullUrl = GITHUB_RAW_BASE + "/" + path.split("/").map(encodeURIComponent).join("/");

  fetch(fullUrl)
    .then(res => {
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      return res.text();
    })
    .then(md => {
      // Render markdown
      content.innerHTML = marked.parse(md);

      // Fix relative image paths in markdown (like your PNGs)
      const basePath = path.split("/").slice(0, -1).join("/");
      content.querySelectorAll("img").forEach(img => {
        const src = img.getAttribute("src");
        if (src && !src.startsWith("http") && !src.startsWith("data:")) {
          img.src = `${GITHUB_RAW_BASE}/${basePath}/${src}`;
        }
      });

      generateTOC();
      updateButtons();
      updateActiveLink();
      autoExpandFolders();


      history.replaceState(null, "", `#${encodeURIComponent(path)}`);
      
     const contentContainer = document.querySelector("main.content");
      if (contentContainer) {
      contentContainer.scrollTop = 0;
      }
 

    })
    .catch(err => {
      content.innerHTML = `<p>Error loading document: ${err.message}</p>`;
      console.error(err);
    });
}


function loadDoc(index) {
  if (index >= 0 && index < flatDocs.length) {
    loadDocByPath(flatDocs[index].path);
  }
}

  function generateTOC() {
    tocList.innerHTML = "";
    const headers = content.querySelectorAll("h2, h3");

  const rightSidebar = document.querySelector(".right-sidebar");
  if (headers.length === 0) {
    rightSidebar.style.display = "none";
    return;
  } else {
    rightSidebar.style.display = "block"; // Show if headers exist
  }

    headers.forEach(header => {
      if (!header.id) header.id = header.textContent.trim().toLowerCase().replace(/\s+/g, '-');
      const li = document.createElement("li");
      const a = document.createElement("a");
      a.href = `#${header.id}`;
      a.textContent = header.textContent;



a.addEventListener("click", (e) => {
  e.preventDefault();

  // Get the target heading element
  const targetId = a.getAttribute("href").substring(1);
  const targetEl = document.getElementById(targetId);
  const scrollContainer = document.querySelector("main.content");

  if (targetEl && scrollContainer) {
    const scrollOffset = 80; // Adjust for header height if needed
    const targetScrollTop = targetEl.offsetTop - scrollContainer.offsetTop - scrollOffset;

    scrollContainer.scrollTo({
      top: targetScrollTop,
      behavior: "smooth"
    });

    // Update the URL hash without jumping
    history.replaceState(null, "", `#${targetId}`);

    // Highlight active link
    document.querySelectorAll('#doc-toc a').forEach(el => el.classList.remove("active"));
    a.classList.add("active");

      // ‚úÖ Scroll TOC item into view within sidebar
    a.scrollIntoView({ block: "nearest", behavior: "smooth" });

  }
});



      li.appendChild(a);
      tocList.appendChild(li);
    });
    
  }

  function updateButtons() {
    prevBtn.disabled = currentIndex === 0;
    nextBtn.disabled = currentIndex === flatDocs.length - 1;
  }

  function updateActiveLink() {
    document.querySelectorAll("#doc-list a").forEach((a, i) => {
      a.classList.toggle("active", i === currentIndex);
    });
  }

function autoExpandFolders() {

  const currentPath = flatDocs[currentIndex].path;
  const folders = currentPath.split("/").slice(1, -1); // skip "docs" and file
  let current = docList;
  folders.forEach(folder => {
    const toggle = [...current.querySelectorAll(".folder-toggle")].find(t => {
      const folderNameSpan = t.querySelector(".folder-name");
      return folderNameSpan && folderNameSpan.textContent.trim().toLowerCase() === folder.replace(/-/g, ' ');
    });
    if (toggle) {
      const dropdown = toggle.nextElementSibling;
      dropdown.classList.add("open");
      const icon = toggle.querySelector(".chevron-icon");
      toggle.classList.add("open");

      current = dropdown;
    }
  });
  if (current && current.closest("li")) {
  const activeFolder = current.closest("li").querySelector(".folder-toggle");
  if (activeFolder) {
    activeFolder.scrollIntoView({ behavior: "smooth", block: "center" });
  }
}
}

  prevBtn.addEventListener("click", () => {
    if (currentIndex > 0) loadDoc(currentIndex - 1);
  });

  nextBtn.addEventListener("click", () => {
    if (currentIndex < flatDocs.length - 1) loadDoc(currentIndex + 1);
  });

searchInput.addEventListener("input", () => {
  const query = searchInput.value.trim().toLowerCase();

  document.querySelectorAll("#doc-list > li").forEach(folderLi => {
    const folderDropdown = folderLi.querySelector(".dropdown");
    const folderToggle = folderLi.querySelector(".folder-toggle");
    const folderNameEl = folderToggle?.querySelector(".folder-name");
    const folderName = folderNameEl?.textContent.toLowerCase() || "";
    let folderHasMatch = false;

    // Match against folder name itself
    const folderNameMatches = folderName.includes(query);

    const fileLinks = folderLi.querySelectorAll("a");
    fileLinks.forEach(link => {
      const title = link.textContent.toLowerCase();
      const match = title.includes(query);

      const li = link.closest("li");
      if (li) li.style.display = match || folderNameMatches || !query ? "block" : "none";

      if (match) folderHasMatch = true;
    });

    const shouldShowFolder = folderHasMatch || folderNameMatches || !query;
    folderLi.style.display = shouldShowFolder ? "block" : "none";

    if (folderDropdown) {
      folderDropdown.classList.toggle("open", shouldShowFolder && query);
      folderToggle?.classList.toggle("open", shouldShowFolder && query);
    }
  });
});


  buildSidebar();


  // Apply default dark theme if no preference is saved
  if (!localStorage.getItem("theme")) {
    document.body.setAttribute("data-theme", "dark");
  }

  // Function to update the toggle icon text
  function updateThemeIcon(theme) {
    const toggleBtn = document.getElementById("theme-toggle");
    if (toggleBtn) {
      toggleBtn.textContent = theme === "dark" ? "üåô" : "‚òÄÔ∏è";
    }
  }

  // Event listener for the theme toggle button
  const toggleBtn = document.getElementById("theme-toggle");
  if (toggleBtn) {
    toggleBtn.addEventListener("click", () => {
      const current = document.body.getAttribute("data-theme");
      const next = current === "dark" ? "light" : "dark";
      document.body.setAttribute("data-theme", next);
      localStorage.setItem("theme", next);
      updateThemeIcon(next);
    });
  }

  // On page load, use saved theme or default to dark
  document.addEventListener("DOMContentLoaded", () => {
    const savedTheme = localStorage.getItem("theme") || "dark";
    document.body.setAttribute("data-theme", savedTheme);
    updateThemeIcon(savedTheme);
  });

const sidebar = document.querySelector(".sidebar");
const backdrop = document.getElementById("sidebar-backdrop");
const body = document.body;

document.getElementById("menu-toggle").addEventListener("click", () => {
  const isOpen = sidebar.classList.toggle("open");
  backdrop.classList.toggle("show", isOpen);
  body.classList.toggle("sidebar-open", isOpen);
});

backdrop.addEventListener("click", () => {
  sidebar.classList.remove("open");
  backdrop.classList.remove("show");
  body.classList.remove("sidebar-open");
});

document.getElementById("sidebar-close").addEventListener("click", () => {
  sidebar.classList.remove("open");
  backdrop.classList.remove("show");
  body.classList.remove("sidebar-open");
});

// === Logo Click Always Reloads if URL and Hash Are the Same ===
document.addEventListener("DOMContentLoaded", () => {
  const logoLink = document.querySelector(".logo a");
  if (!logoLink) return;

  logoLink.addEventListener("click", (e) => {
    const targetHref = logoLink.getAttribute("href");
    const fullTargetURL = new URL(targetHref, window.location.origin).href;

    // Compare the full target URL to current location
    if (window.location.href === fullTargetURL) {
      e.preventDefault();
      location.reload();
    }
    // Otherwise let browser handle normal navigation
  });
});

window.addEventListener("hashchange", () => {
  const newPath = decodeURIComponent(location.hash.slice(1));
  if (flatDocs.some(doc => doc.path === newPath)) {
    loadDocByPath(newPath);
  }
});

document.addEventListener("DOMContentLoaded", () => {
  const navLinksToReload = [
    "docs.html#docs%2Fmanuals-and-cheat-sheets%2FGet%20Started.md",
    "docs.html#docs%2Fmanuals-and-cheat-sheets%2FContribute%20to%20Creator%20Documentation.md"
  ];

  document.querySelectorAll("nav.nav-links a").forEach(link => {
    link.addEventListener("click", (e) => {
      const currentUrl = window.location.href;
      const linkHref = link.href;

      // If clicked link's href is exactly the current page URL, reload page
      if (linkHref === currentUrl && navLinksToReload.some(nr => linkHref.includes(nr))) {
        e.preventDefault();
        window.location.reload();
      }
    });
  });
});

</script>
</body>
</html>
